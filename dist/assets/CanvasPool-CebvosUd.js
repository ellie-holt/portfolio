import{B as p}from"./colorToUniform-r1IX7RmM.js";import{T as C,D as d,n as u}from"./index-DYv8XAXM.js";const v={};function f(n,t,o){let e=2166136261;for(let a=0;a<t;a++)e^=n[a].uid,e=Math.imul(e,16777619),e>>>=0;return v[e]||h(n,t,e,o)}function h(n,t,o,e){const a={};let s=0;for(let c=0;c<e;c++){const l=c<t?n[c]:C.EMPTY.source;a[s++]=l.source,a[s++]=l.style}const r=new p(a);return v[o]=r,r}class i{constructor(t){this._canvasPool=Object.create(null),this.canvasOptions=t||{},this.enableFullScreen=!1}_createCanvasAndContext(t,o){const e=d.get().createCanvas();e.width=t,e.height=o;const a=e.getContext("2d");return{canvas:e,context:a}}getOptimalCanvasAndContext(t,o,e=1){t=Math.ceil(t*e-1e-6),o=Math.ceil(o*e-1e-6),t=u(t),o=u(o);const a=(t<<17)+(o<<1);this._canvasPool[a]||(this._canvasPool[a]=[]);let s=this._canvasPool[a].pop();return s||(s=this._createCanvasAndContext(t,o)),s}returnCanvasAndContext(t){const o=t.canvas,{width:e,height:a}=o,s=(e<<17)+(a<<1);t.context.clearRect(0,0,e,a),this._canvasPool[s].push(t)}clear(){this._canvasPool={}}}const _=new i;export{_ as C,f as g};
